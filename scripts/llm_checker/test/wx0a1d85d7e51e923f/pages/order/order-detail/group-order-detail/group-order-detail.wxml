<import src="/pages/template/toast/toast.wxml"></import>
<import src="/pages/template/footer/footer.wxml"></import>
<template is="toast" data="{{..._toast_}}"></template>
<view class="" style="padding-bottom: 120rpx" wx:if="{{pageData}}">
  <view class="padding {{isUy?'rtl':''}}">
    <view class="text-xl uy-tom text-bold text-black">
      <text class="text-red" wx:if="{{pageData.pay_state==0}}"
        >{{Str.unpayed[lanIndex]}}</text
      >
      <text
        class="text-cyan"
        wx:if="{{pageData.pay_state!=0&&pageData.order_state==0}}"
        >{{Str.waitUsed[lanIndex]}}</text
      >
      <text wx:if="{{pageData.pay_state!=0&&pageData.order_state==2}}"
        >{{Str.completed[lanIndex]}}</text
      >
      <text
        class="text-red"
        wx:if="{{pageData.pay_state!=0&&pageData.order_state==-2}}"
        >{{Str.canceld[lanIndex]}}</text
      >
    </view>
  </view>
  <view
    class="bg-white cart margin-sm padding-sm"
    wx:if="{{pageData.pay_state==1&&pageData.order_state==0&&isOwner}}"
  >
    <view>
      <text class="text-xl text-bold uy-tom text-black {{isUy?'rtl':''}}"
        >{{Str.checkCode[lanIndex]}}</text
      >
    </view>
    <view class="text-center padding">
      <image
        src="{{pageData.id_img_url}}"
        style="width: 200rpx; height: 200rpx"
      ></image>
    </view>
  </view>
  <view
    class="padding flex bg-white margin-lr-sm"
    wx:if="{{isManager&&pageData.pay_state==1&&pageData.order_state==0}}"
  >
    <view class="flex-sub">
      <button bind:tap="cancelBtn" class="cu-btn bg-red">
        {{Str.cancel[lanIndex]}}
      </button>
    </view>
    <view>
      <button bind:tap="confirmBtn" class="cu-btn bg-green">
        {{Str.confirm[lanIndex]}}
      </button>
    </view>
  </view>
  <view>
    <view
      class="bg-white padding-sm margin-lr-sm margin-tb-sm radius flex justify-between cart {{isUy?'rtl':''}} align-center"
    >
      <view class="flex">
        <view
          class="bg-img"
          style="background-image: url({{ossImage+pageData.shop.icon_url}});width: 140rpx;height: 140rpx;border-radius: 12rpx;"
        ></view>
        <view class="padding-lr-sm">
          <view class="text-black uy-tom text-lg"
            >{{isUy?pageData.shop.uy_name:pageData.shop.ch_name}}</view
          >
          <view>
            <text class="text-sm"
              >{{isUy?pageData.shop.uy_address:pageData.shop.ch_address}}</text
            >
            <text decode="true">&nbsp;&nbsp;&nbsp;</text>
            <text wx:if="{{pageData.shop.distance>=0}}"
              >{{pageData.shop.distance}}</text
            >
          </view>
          <view class="text-sm">
            <text>{{Str.shoppingTime[lanIndex]}}</text>
            <text> : </text>
            <text
              >{{pageData.shop.start_time}} ~ {{pageData.shop.end_time}}</text
            >
          </view>
        </view>
      </view>
      <view
        bindtap="callPhone"
        class="text-center"
        data-phone="{{pageData.shop.contact_phone}}"
      >
        <view class="text-xl">
          <text class="icon-phone"></text>
        </view>
        <view class="text-black">{{Str.contact[lanIndex]}}</view>
      </view>
    </view>
  </view>
  <view class="bg-white cart margin-sm padding-sm">
    <view class="{{isUy?'rtl':''}}">
      <text class="text-xl text-black text-bold padding-lr-sm uy-tom"
        >{{Str.setMealDetail[lanIndex]}}</text
      >
    </view>
    <view class="margin-xs bg-white padding-sm {{isUy?'rtl':''}}">
      <view
        wx:for="{{pageData.goods[0].group_good.cats}}"
        wx:for-item="_item"
        wx:key="index"
      >
        <view>
          <text class="icon-title"></text>
          <text class="text-black text-bold uy-tom"
            >{{isUy?_item.uy_name:_item.ch_name}}</text
          >
        </view>
        <view
          class="padding-lr margin-tb-xs"
          wx:for="{{_item.items}}"
          wx:for-item="__item"
          wx:key="index"
        >
          <view class="flex justify-between">
            <view>
              <text class="text-lg"
                >{{isUy?__item['good']['uy_name']:__item['good']['ch_name']}}</text
              >
            </view>
            <view>
              <text class="text-gray"
                >({{__item.good_count}} {{Str.fen[lanIndex]}})</text
              >
              <text decode="true">&nbsp;&nbsp;&nbsp;&nbsp;</text>
              <text class="text-price text-lg text-black"
                >{{__item['price']*__item['good_count']}}</text
              >
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="margin-lr-sm">
    <view class="radius bg-white margin-top">
      <item hasArrow="{{0}}" isUy="{{isUy}}">
        <view class="text-black text-bold text-lg" slot="content"
          >{{Str.buyerKnow[lanIndex]}}</view
        >
      </item>
    </view>
    <view class="bg-white padding-sm radius margin-tb-xs">
      <view class="{{isUy?'rtl':''}}">
        <view class="text-black text-bold text-lg">
          <text class="icon-calendar padding-lr-xs"></text>
          {{Str.validPeriod[lanIndex]}}
        </view>
        <view class="padding-lr-xl solid-bottom padding-bottom-sm"
          >{{Str.groupCanUsedLimit[lanIndex]}}</view
        >
      </view>
      <view class="{{isUy?'rtl':''}}">
        <view class="text-black text-bold text-lg">
          <text class="icon-time padding-lr-xs"></text>
          {{Str.usedTime[lanIndex]}}
        </view>
        <view class="padding-lr-xl solid-bottom padding-bottom-sm"
          >{{Str.groupUsedTimeLimit[lanIndex]}}</view
        >
      </view>
    </view>
  </view>
  <view class="cart bg-white margin-sm padding-sm {{isUy?'rtl':''}} ">
    <view class="text-xl uy-tom text-black {{isUy?'rtl':''}}">
      <text>{{Str.actulyPayed[lanIndex]}}</text>
      <text> : </text>
      <text class="text-price">{{pageData.actual_fee}}</text>
    </view>
    <view class="text-lg padding-tb-xs">
      <text class="text-gray">{{Str.orderNo[lanIndex]}}</text>
      <text> : </text>
      <text class="text-black">{{pageData.order_no}}</text>
      <button class="cu-btn sm bg-black margin-lr-sm">
        {{Str.copy[lanIndex]}}
      </button>
    </view>
    <view class="text-lg padding-tb-xs flex">
      <text class="text-gray">{{Str.takeOrderTime[lanIndex]}}</text>
      <text> : </text>
      <view class="text-black ltr padding-lr-xs">{{pageData.created_at}}</view>
    </view>
    <view class="text-lg padding-tb-xs flex" wx:if="{{pageData.arrived_time}}">
      <text class="text-gray">{{Str.completedTime[lanIndex]}}</text>
      <text> : </text>
      <view class="text-black ltr padding-lr-xs"
        >{{pageData.arrived_time}}</view
      >
    </view>
    <view class="text-lg padding-tb-xs flex">
      <text class="text-gray">{{Str.quantity[lanIndex]}}</text>
      <text class="padding-lr-sm"> : </text>
      <view class="text-black ltr padding-lr-xs"
        >{{pageData.goods[0].count}}</view
      >
    </view>
    <view class="text-lg padding-tb-xs flex">
      <text class="text-gray">{{Str.totalPrice[lanIndex]}}</text>
      <text class="padding-lr-sm"> : </text>
      <view class="text-black ltr padding-lr-xs text-price"
        >{{pageData.total_fee}}</view
      >
    </view>
    <view class="text-lg padding-tb-xs flex">
      <text class="text-gray">{{Str.actualyPayed[lanIndex]}}</text>
      <text class="padding-lr-sm"> : </text>
      <view class="text-black ltr padding-lr-xs text-price"
        >{{pageData.actual_fee}}</view
      >
    </view>
  </view>
</view>
<dialog
  cancel="{{Str.cancel[lanIndex]}}"
  confirm="{{Str.confirm[lanIndex]}}"
  content="{{dialogContent}}"
  id="dialog"
  isInput="{{dialogIsInput}}"
  title="{{Str.warning[lanIndex]}}"
  type="normal"
></dialog>
<loading hidden="{{!isLoading}}">{{Str.loadingTxt[lanIndex]}}</loading>
