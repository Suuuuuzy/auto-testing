<import src="/pages/template/toast/toast.wxml"></import>
<import src="/pages/template/footer/footer.wxml"></import>
<import src="/pages/template/shop-item/shop-item.wxml"></import>
<template is="toast" data="{{..._toast_}}"></template>
<view wx:if="{{result}}">
  <view class="bg-white padding-sm solid-top flex text-center margin-bottom-xs">
    <view bindtap="selectCatClick" class="flex-sub">
      <view class="text-black" wx:if="{{catSelectIndex!=-1}}">
        <text
          >{{isUy?result.cat[catSelectIndex].uy_name:result.cat[catSelectIndex].ch_name}}</text
        >
        <text class="icon-triangledownfill"></text>
      </view>
    </view>
    <view class="flex-sub"></view>
    <view class="flex-sub"></view>
  </view>
  <view
    class="{{result.setting.is_open==1&&item.is_open==1||item.is_volunteer==1?'':'grayscale'}} margin-lr-xs margin-bottom-xs"
    wx:for="{{result.shops.data}}"
    wx:key="index"
  >
    <template
      is="_shopListItem"
      data="{{isUy:isUy,Str:Str,lanIndex:lanIndex,item:item,ossImage:ossImage,navUrl:'/pages/home/mall/mall-home'}}"
    ></template>
  </view>
  <view
    class="solids-top bg-white {{result.setting.is_open==1&&item.is_open==1?'':'grayscale'}}"
    wx:if="{{0}}"
    wx:for="{{result.shops.data}}"
    wx:key="index"
  >
    <navigator
      class="padding-tb-sm padding-right-sm flex"
      url="/pages/home/shop/shop-detail/shop-detail?shopId={{item.id}}&title={{isUy?item.uy_name:item.ch_name}}"
    >
      <view class="flex-sub text-center">
        <view
          bindtap="viewImg"
          class="cu-avatar radius"
          data-url="{{ossImage+item.icon_url}}"
          style="background-image:url({{ossImage+item.icon_url+'?x-oss-process=image/resize,m_lfit,h_200,w_200'}});width:160rpx; height:160rpx"
        >
          <view
            class="bg-cyan text-sm"
            style="position: absolute; bottom: 0; width: 100%"
            wx:if="{{item.activity_count>0}}"
            >{{Str.activity[lanIndex]}}</view
          >
        </view>
      </view>
      <view class="flex-treble">
        <view class="text-lg text-black"
          >{{isUy?item.uy_name:item.ch_name}}</view
        >
        <view class="shop-title">
          <view class="flex justify-between">
            <view class="text-sm">
              <text
                class="icon icon-favorfill text-{{index<item.star_count?'yellow':'gray'}}"
                wx:for="{{5}}"
                wx:for-item="_item"
                wx:key="index"
              ></text>
            </view>
            <view class="{{isUy?'rtl':''}}" style="">
              <text class="text-sm text-cyan"
                >{{item.arrive_time}}{{Str.minut[lanIndex]}}</text
              >
              <text
                class="text-grey text-sm padding-lr-xs"
                wx:if="{{item.distance&&item.distance!=-1}}"
                >|</text
              >
              <text
                class="text-sm text-pink"
                wx:if="{{item.distance&&item.distance!=-1}}"
                >{{item.distance}}</text
              >
            </view>
          </view>
        </view>
        <view class="flex justify-start">
          <view class="{{isUy?'rtl':''}} text-sm"
            >{{Str.startPrice[lanIndex]}}
            <text class="text-price text-pink">{{item.starting_price}}</text>
          </view>
          <view class="text-grey padding-lr-xs text-sm"> | </view>
          <view class="{{isUy?'rtl':''}} text-sm" wx:if="{{result.setting}}"
            >{{Str.deliveryFee[lanIndex]}}
            <text class="text-price text-pink">{{item.delivery_fee}}</text>
          </view>
        </view>
        <view class="flex justify-start padding-top-xs">
          <view class="cu-tag line-pink radius sm uy" wx:if="{{item.area}}"
            >{{isUy?item.area.uy_name:item.area.ch_name}}</view
          >
          <view
            class="margin-left-sm cu-tag line-cyan radius sm uy"
            wx:if="{{item.cat}}"
            >{{isUy?item.cat.uy_name:item.cat.ch_name}}</view
          >
        </view>
      </view>
    </navigator>
  </view>
  <view>
    <view class="weui-loadmore weui-loadmore_line">
      <view
        class="weui-loadmore__tips weui-loadmore__tips_in-line"
        style="background-color: #f1f1f1"
        >{{Str.noContent[lanIndex]}}</view
      >
    </view>
  </view>
</view>
<view
  bindtap="hideModal"
  class="cu-modal {{modalName=='selectModal'?'show':''}}"
>
  <view catchtap class="cu-dialog">
    <radio-group bindchange="selectChange" class="block">
      <view class="cu-list menu text-left">
        <view class="cu-item" wx:for="{{selectData}}">
          <label class="flex justify-between align-center flex-sub">
            <view class="flex-sub">{{isUy?item.uy_name:item.ch_name}}</view>
            <radio
              checked="{{item.checked}}"
              class="round"
              value="{{index}}"
            ></radio>
          </label>
        </view>
      </view>
    </radio-group>
  </view>
</view>
<loading hidden="{{!isLoading}}">{{Str.loadingTxt[lanIndex]}}</loading>
